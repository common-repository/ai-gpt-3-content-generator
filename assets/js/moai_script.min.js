jQuery(document).ready((function(){moai_change_playground({target:{id:"content_writer"}}),void 0!==jQuery("#engine")&&moai_show_model_desc()}));var playground_mode="content_writer";function moai_show_model_desc(){jQuery(".moai-model-info").css("display","none"),jQuery("#"+jQuery("#engine").val()+"-info").css("display","block")}function moai_enter_save(){var key;return 13!==window.event.keyCode||(moai_process_query(),!1)}function moai_build_query_based_on_playground_mode(){var query="";switch(playground_mode){case"content_writer":var blog_topic=jQuery("#input-blog-topic").val(),word_count=jQuery("#input-word-count").val();if(!blog_topic||!word_count)break;query="We are writing a blog on WordPress the topic for the blog is: "+blog_topic+". Make sure the blog has an introduction and a conclusion too. The number of words should be:"+word_count;break;case"translate":var blog_content=jQuery("#input-blog-content").val(),translate_language=jQuery("#input-translate-language").val();if(!blog_content||!translate_language)break;query="Translate the article below in "+translate_language+": "+blog_content;break;case"proofreader":var blog_content;if(!(blog_content=jQuery("#input-blog-content").val()))break;query="Below is some content for a blog we wrote Fix the grammar and spelling mistakes:"+blog_content;break;case"summary":var blog_content;if(!(blog_content=jQuery("#input-blog-content").val()))break;query="Write a summary for the text below:"+blog_content;break;case"seo":var blog_content;if(!(blog_content=jQuery("#input-blog-content").val()))break;query="For the following article, write a SEO-friendly and short title, keywords for Google, and a short excerpt to introduce it. Use this format:\n\nTitle:\nKeywords:\nExcerpt: "+blog_content;break;case"wp_assistant":case"playground":var querybox=jQuery("#querybox").val();if(!querybox)break;query="\nHuman: "+querybox}return query}function moai_process_query(){var resultbox=jQuery("#input-resultbox"),preloader=jQuery("#moai-preloader"),btn=jQuery("#sendbtn"),querybox=jQuery("#querybox"),query=moai_build_query_based_on_playground_mode();"wp_assistant"!==playground_mode&&"playground"!==playground_mode||(query=resultbox.val()+"\n"+query),moai_display_user_input_in_playground(preloader,btn,query,resultbox,querybox);let formdata=new FormData;formdata.append("query",query),formdata.append("action-type","answer_query"),formdata.append("action","moai_ajax_action"),formdata.append("replies","1"),formdata.append("_wpnonce",ajax_object_moai.moai_ajax_nonce),ajax_request=jQuery.ajax({url:ajax_object_moai.ajax_url_moai,type:"POST",data:formdata,processData:!1,contentType:!1}),ajax_request.done(response=>{moai_display_response_in_playground(resultbox,response,preloader,querybox,btn)}),ajax_request.fail(response=>{preloader.css("display","none"),querybox.prop("disabled",!1),alert("Something went wrong retry")})}function moai_display_user_input_in_playground(preloader,btn,query,resultbox,querybox){btn.prop("disabled",!0),"wp_assistant"!==playground_mode&&"playground"!==playground_mode?(preloader.css("display","block"),jQuery([document.documentElement,document.body]).animate({scrollTop:preloader.offset().top},2e3),moai_set_playground_result_title("Processing your request"),btn.hide()):(resultbox.val(query),querybox.prop("disabled",!0),querybox.val(""),resultbox.scrollTop(resultbox[0].scrollHeight))}function moai_display_response_in_playground(resultbox,response,preloader,querybox,btn){"wp_assistant"!==playground_mode&&"playground"!==playground_mode?(resultbox.val(response.data[0].text.trim()),preloader.css("display","none"),jQuery("#playground-input-resultbox").css("display","block"),moai_show_result_title(),moai_playground_hide_submit_button(),jQuery(".moai-reset-pg-btn").attr("name",playground_mode)):(moai_parse_and_set_ai_response(response.data[0].text.trim(),resultbox),querybox.prop("disabled",!1),resultbox.scrollTop(resultbox[0].scrollHeight)),btn.prop("disabled",!1),querybox.prop("disabled",!1)}function moai_parse_and_set_ai_response(ai_response,resultbox){var ai_alias="AI:";ai_response.replace(/[\r\n]/g,""),ai_response.trim();var res_start_index=ai_response.indexOf("AI:"),prompt_completion="",prompt_response="";-1!==res_start_index&&(prompt_completion=ai_response.substring(0,res_start_index),prompt_response=ai_response.substring(res_start_index)),resultbox.val(resultbox.val().trim()+" "+prompt_completion+"\n\n"+prompt_response)}function moai_show_result_title(){switch(playground_mode){case"content_writer":moai_set_playground_result_title("Here is the content for your blog.");break;case"translate":moai_set_playground_result_title("Here is your translated blog:");break;case"proofreader":moai_set_playground_result_title("Here is your blog after correcting a few mistakes");break;case"summary":moai_set_playground_result_title("Here is the summary / excerpt for your blog");break;case"seo":moai_set_playground_result_title("Here is the SEO for your blog")}}function moai_change_playground(ev){var res_box=jQuery("#input-resultbox");playground_mode=ev.target.id,moai_change_selected_button(),moai_set_prompt_and_controls(res_box)}function moai_change_selected_button(){jQuery(".moai-prompt-selector-btn").removeClass("moai-selected-btn"),jQuery("#"+playground_mode).addClass("moai-selected-btn")}function moai_show_query_section(query_mode="input",btn_text="Submit Query"){switch(jQuery(".moai-query-box").css("display","block"),query_mode){case"input":jQuery(".moai-query-container").css("display","flex"),jQuery(".moai-query-submit-btn").css("display","none");break;case"button":jQuery(".moai-query-container").css("display","none"),jQuery(".moai-query-submit-btn").css("display","block"),jQuery(".moai-query-submit-btn").html(btn_text)}}function moai_set_playground_title(title){jQuery("#moai-playground-title").html(title)}function moai_set_playground_result_title(title){jQuery("#moai-playground-result-title").html(title)}function moai_playground_hide_all_inputs(){jQuery(".moai-playground-input-div").css("display","none"),jQuery(".moai-playground-input").prop("required",!1),jQuery("input.moai-playground-input:text").val(""),jQuery(".moai-content-input-textarea").val(""),moai_playground_hide_submit_button()}function moai_playground_hide_submit_button(){jQuery(".moai-query-box").css("display","none")}function moai_show_input_and_set_required(input_ids){input_ids.forEach(input_id=>{var display="flex";"blog-content"===input_id&&(display="block"),jQuery("#playground-input-"+input_id).css("display",display),jQuery("#input-"+input_id).prop("required",!0)})}function moai_set_prompt_and_controls(res_box){switch(jQuery("#moai-playground-result-title").show(),jQuery("#moai-copy-to-clipboard-btn").show(),jQuery("#moai-reset-playground-btn").show(),moai_playground_hide_all_inputs(),playground_mode){case"content_writer":moai_set_playground_title("Enter parameters for the blog"),moai_show_input_and_set_required(["blog-topic","word-count"]),moai_show_query_section("button","Generate content");break;case"proofreader":moai_set_playground_title("Enter content for Proofreading"),moai_show_input_and_set_required(["blog-content"]),moai_show_query_section("button","Check for mistakes");break;case"summary":moai_set_playground_title("Enter content to generate Summery/Excerpt"),moai_show_input_and_set_required(["blog-content"]),moai_show_query_section("button","Summarize");break;case"translate":moai_set_playground_title("Provide content and select language for translation"),moai_show_input_and_set_required(["blog-content","translate-language"]),moai_show_query_section("button","Translate");break;case"seo":moai_set_playground_title("Provide content for SEO"),moai_show_input_and_set_required(["blog-content"]),moai_show_query_section("button","Perform SEO analysis");break;case"wp_assistant":moai_set_playground_title("WordPress Assistant Mode"),moai_show_input_and_set_required(["resultbox"]),res_box.val("Converse as a WordPress expert. Be helpful, friendly, concise, avoid external URLs and commercial solutions.\n\nAI: Hi! How can I help you with WordPress today?\n"),moai_show_query_section("input"),jQuery("#moai-playground-result-title").hide(),jQuery("#moai-copy-to-clipboard-btn").hide(),jQuery("#moai-reset-playground-btn").hide();break;case"playground":moai_set_playground_title("AI Playground Mode"),moai_show_input_and_set_required(["resultbox"]),res_box.val("Interact freely with AI, provide your query and AI will respond."),moai_show_query_section("input"),jQuery("#moai-playground-result-title").hide(),jQuery("#moai-copy-to-clipboard-btn").hide(),jQuery("#moai-reset-playground-btn").hide()}}function moai_process_img_query(){var querybox=jQuery("#qbox"),status=jQuery("#status"),btn=jQuery("#sendbtn"),query=querybox.val();if(""==query||null==query)return void alert("Enter something");querybox.prop("disabled",!0),status.prop("hidden",!1),btn.prop("disabled",!0);let formdata=new FormData;formdata.append("query",query),formdata.append("action-type","generate_image"),formdata.append("action","moai_ajax_action"),formdata.append("_wpnonce",ajax_object_moai.moai_ajax_nonce),ajax_request=jQuery.ajax({url:ajax_object_moai.ajax_url_moai,type:"POST",data:formdata,processData:!1,contentType:!1}),ajax_request.done(response=>{jQuery("#moai-image-title").text("Image For: "+query),jQuery("#placeholderimg").html('<img id="moai-generated-img" src="'+response.data+'" width=512 height=512 alt="Cant render image" />'),jQuery("#after_image_saved").css("display","none"),jQuery(".moai-image-options").css("display","block"),jQuery("#image_save_status").html(""),status.prop("hidden",!0),querybox.prop("disabled",!1),querybox.val(""),btn.prop("disabled",!1)}),ajax_request.fail(response=>{status.prop("hidden",!0),querybox.prop("disabled",!1),querybox.val(""),btn.prop("disabled",!1),alert("Something went wrong retry.")})}function moai_save_to_media_library(){var imageUrl=jQuery("#moai-generated-img").attr("src"),image_title=jQuery("#image_title").val();if(!image_title)return void alert("Please provide a title for the image");moai_show_success_message("Saving image to Media Library please wait");let formdata=new FormData;formdata.append("action-type","save_image"),formdata.append("action","moai_ajax_action"),formdata.append("query","save_image"),formdata.append("image_url",imageUrl),formdata.append("image_title",image_title),formdata.append("_wpnonce",ajax_object_moai.moai_ajax_nonce),ajax_request=jQuery.ajax({url:ajax_object_moai.ajax_url_moai,type:"POST",data:formdata,processData:!1,contentType:!1}),ajax_request.done(response=>{jQuery("#after_image_saved").css("display","block"),moai_show_success_message(response.data.message),response.data.attachment_url&&jQuery("#view_image_attachment").attr("href",response.data.attachment_url)}),ajax_request.fail(response=>{alert(response.data.message)})}function moai_show_success_message(message){jQuery(".moai-message-success").text(message).fadeIn(),setTimeout((function(){jQuery(".moai-message-success").fadeOut()}),5e3)}function moai_copy_text_to_clipboard(element_id){navigator.clipboard.writeText(jQuery("#"+element_id).val()),moai_show_success_message("Text Copied to Clipboard")}function moai_reset_playground(event){moai_change_playground({target:{id:event.target.name}})}